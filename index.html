<!DOCTYPE html>
<html lang="en" ng-app="weatherApp">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
    <link rel="stylesheet" href="style.css">
  </head>

  <body ng-controller="AppController">
    <section class=" w-screen h-screen overflow-y-scroll overflow-x-hidden bg-[conic-gradient(at_right,_var(--tw-gradient-stops))] from-indigo-200 via-slate-600 to-indigo-200">
      <div class=" ">
        <div class="flex justify-between w-screen lg:flex lg:justify-between lg:h-max lg:w-screen lg:py-4">
          <span class="text-[255%] font-semibold lg:font-semibold text-transparent bg-clip-text bg-gradient-to-r from-red-600 to-purple-600 lg:text-5xl lg:ml-4 ml-2 mb-2">
            Weather
          </span>
          <span class="flex mt-[1.5%] lg:px-4 lg:flex lg:m-0">
            <input class="w-[150%] h-[85%] lg:h-max px-4 bg-[#2b4162]/30 rounded-l-full lg:bg-[#2b4162] lg:bg-opacity-30 lg:rounded-l-full lg:py-3 lg:w-96 lg:px-4 text-white lg:focus:outline-none lg:focus:ring lg:focus:ring-[#2b4162] lg:m-0 ml-10 mb-0"
              type="search" name="City" id="city" placeholder="City" ng-model="tempValue" ng-keydown="handleKeyDown($event)" />
            <button class="bg-[#2b4162] bg-opacity-30 focus:outline-none pr-4 rounded-r-full focus:ring focus:ring-[#2b4162] active:bg-slate-800 lg:bg-[#2b4162] lg:bg-opacity-30 lg:rounded-r-full lg:py-2 lg:pr-4 lg:focus:outline-none lg:focus:ring lg:focus:ring-[#2b4162] lg:active:bg-slate-800 mr-2 h-[85%] lg:h-max"
              ng-click="submitSearch()">
              <svg width="32px" height="32px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path opacity="0.1"
                  d="M17 10C17 13.866 13.866 17 10 17C6.13401 17 3 13.866 3 10C3 6.13401 6.13401 3 10 3C13.866 3 17 6.13401 17 10Z"
                  fill="#323232" />
                <path d="M15 15L21 21" stroke="#323232" stroke-width="2" stroke-linecap="round"
                  stroke-linejoin="round" />
                <path d="M17 10C17 13.866 13.866 17 10 17C6.13401 17 3 13.866 3 10C3 6.13401 6.13401 3 10 3C13.866 3 17 6.13401 17 10Z"
                  stroke="#323232" stroke-width="2" />
              </svg>
            </button>
          </span>
        </div>
      </div>

     

    <div class=" w-[90vw] md:w-[70vw] lg:w-[40vw] h-max py-4 bg-gray-500/50 mx-auto rounded-lg mt-6 shadow-xl px-4" 
      ng-if="weatherData">
        <div class="flex w-full justify-between text-white text-5xl">
            <h2>{{ weatherData.location.name }}</h2>
            <p>{{ weatherData.current.temp_c }}Â°C</p>
        </div>
        <p class="text-white my-1 text-xl ">Region: {{ weatherData.location.region }}, {{ weatherData.location.country }}</p>
        <div class="mx-auto  w-72 h-72 md:w-96 md:h-96 rounded-lg relative">
            <p class="absolute  w-72 h-72 md:w-96 md:h-96 rounded-lg bg-black/50 grid place-content-center text-white text-3xl">{{ weatherData.current.condition.text }}</p> 
            <img class="mx-auto  w-72 h-72 md:w-96 md:h-96 rounded-lg" ng-src="https://image-get.vercel.app/ashishkumar74624@gmail.com/Day/{{ weatherData.current.condition.textWithoutSpaces }}.webp" alt="Weather Image" >
        </div>
    </div>

     <div id="project details" class="mb-14 w-[90vw] md:w-[70vw] lg:w-[50vw] flex flex-col items-center h-max py-4 bg-gray-500/50 mx-auto rounded-lg mt-6 shadow-xl px-4" >
        <h2 class=" text-3xl md:text-5xl text-white "> Angular Js Project  </h2>
        <h2 class=" text-3xl md:text-5xl text-white "> Weather App </h2>
        <h4 class="text-2xl text-white mt-2">21CSL581</h4>
        <p class="text-lg md:text-xl text-white mt-2">Ashish Kumar | 1RN21IS026 </p>
        <p class="text-white my-1 text-lg md:text-xl ">Staff in charge : Mr. Janardhan Singh K </p>
        <p class="text-white my-1 text-lg md:text-xl "> Designation : Assistant Professor </p>
        <p class="text-white my-1 text-2xl md:text-3xl "> RNS Institute of Technology </p>
    </div>


      <!-- Define the AngularJS module and controller -->
    </section>
    <script>
      var app = angular.module('weatherApp', []);

      app.controller('AppController', function($scope, WeatherService) {
        $scope.weatherData = null;

        // Function to fetch weather data
        $scope.fetchWeather = function(city) {
          WeatherService.getWeather(city)
            .then(function(response) {
              $scope.weatherData = response.data;
            })
            .catch(function(error) {
              console.error('Error fetching weather data:', error);
            });
        };

        // Function to handle search input
        $scope.handleKeyDown = function(event) {
          if (event.key === 'Enter') {
            event.preventDefault();
            $scope.submitSearch();
          }
        };

        // Function to submit search
        $scope.submitSearch = function() {
          var city = $scope.tempValue;
          if (city) {
            $scope.fetchWeather(city);
          }
        };
        $scope.preprocessData = function() {
      if ($scope.weatherData) {
        $scope.weatherData.current.condition.textWithoutSpaces = $scope.weatherData.current.condition.text.replace(/\s+/g, '');
      }
    };

    // Call preprocessData function whenever weatherData changes
    $scope.$watch('weatherData', $scope.preprocessData);
      });


      app.service('WeatherService', function($http) {
        this.getWeather = function(city) {
          var apiKey = 'c7c55c62a62f4983884114352232903'; // Replace with your API key
          var apiUrl = 'https://api.weatherapi.com/v1/current.json?key=' + apiKey + '&q=' + city + '&aqi=no';
          return $http.get(apiUrl);
        };
      });

      

    </script>

  </body>

</html>
